{% extends 'blog/base.html' %}
{% load static %}

{% block content %}
    <section class="section">
        <div class="container">
            <hr>

            <h1 class="title">推定テーマ：{{ post.title }}</h1>
            <div class="content">
                {{ post.text | linebreaks }}
            </div>
            <h4>　{% if post.formula_out %}= {{ post.formula_out }}</h4>
            <a href="{% url 'blog:comment_create' post.pk %}" class="button">因子を追加</a>
            <a href="{% url 'blog:post_update' post.pk %}" class="button">式を変更</a>
            {% else %}
            <a href="{% url 'blog:comment_create' post.pk %}" class="button">因子を追加</a>
            <a href="{% url 'blog:post_update' post.pk %}" class="button">定式化</a>
            {% endif %}
            <hr>
            <h2 class="title is-4">ツリー</h2>
            {% for comment in comment_list %}
                <div class="box">
                    {% if comment.value and comment.formula_out %}
                    <p>{{ comment.text }}= {{ comment.formula_out }}</p>
                    {{ comment.value }}
                    {% elif comment.value %}
                    <p>{{ comment.text }}</p>
                    <p>値： {{ comment.value }}</p>
                    {% elif comment.formula_out %}
                    <p>{{ comment.text }}= {{ comment.formula_out }}</p>
                    {% else %}
                    <p><font color="red">{{ comment.text }}</font></p>
                    <a href="{% url 'blog:reply_create' comment.pk %}" class="button">因子を追加</a>
                    <a href="{% url 'blog:comment_update' post.pk comment.pk %}" class="button">定式化</a>
                    <a href="{% url 'blog:add_value' post.pk comment.pk %}" class="button">数値を代入</a>
                    {% endif %}
                    {% with reply_list=comment.comment_set.all %}
                        {% include 'blog/includes/reply.html' %}
                    {% endwith %}
                </div>
            {% endfor %}
            <h2 class="title is-4">推定結果</h2>
              {% if result %}
              <p class="title is-6">{{ result }}</p>
              {% else %}
              <div class="box">
                <p>計算結果はありません</p>
              </div>
              {% endif %}
              <a href="/">戻る</a>
        </div>

    </section>
{% endblock %}
